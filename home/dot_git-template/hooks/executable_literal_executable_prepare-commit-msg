{{ if (and (not .personal) (not .ephemeral)) -}}
#!/bin/bash

COMMIT_MSG_FILE=$1
COMMIT_SOURCE=$2
SHA1=$3

if [[ -z "$COMMIT_SOURCE" || "$COMMIT_SOURCE" == "message" ]]
then
    ref=$(git rev-parse --abbrev-ref HEAD)
    if [[ $ref =~ ^.*((CLN|PT|NTG|DIRDATA|PPE|VITALS|VITALSWWW|CARE|SIM|REVENUE|LBU|ELHD|QXMD|WEBOPS|PLATFORM|PLATENG|WOO|CMSOPS|MQ|SYSTEMS|FMC|HEAL20|PER|TKOF|TCARE|THCO|TWNBT|PAT|TKOD|TKAT|SWAUTO|CONTR|TU|TRUCR|TSI|TF|TPDF|TCAPI|TCC|TUQET|TSDM|VITALSDATA|CDCX|EDI|CC|STA|PROMO|TIDS|MED|TNCC|TEE|MEDSIMS|WGA|ASP|ULDP|MSCPUK|ODV|WSPRO|TCCN|JIMFR|PO|HCPDSC|DTOPS|ASP|OPS|ADM|EUDEVOPS|GENAI|AFLI|CONSAIM|CONSCM|CONSCMS|CONSCP|CONSIN|CONSMEDIA|CONSOPS|CONSPCE|CONSREG|CONSSER|CONSSO|CONSSP|CONSFE|EDUVUE|EMAILP|ESE|FAP|HELIOS|MEDAF|MEDSP|NLB|OOD|PMR|PROFADS|PROFCME|PROFCOM|PROFCORE|PROFCP|PROFEED|PROFMEM|PROFNGX|PROMENG|UVDSITE|WBMDMOB|WBMDTO|WPERF)-[0-9]{1,5}).* ]]
    then
        hint=$(cat "$COMMIT_MSG_FILE")
        ticket="${BASH_REMATCH[1]}"
        echo "[${ticket}] " > "$COMMIT_MSG_FILE"
        echo "$hint" >> "$COMMIT_MSG_FILE"
    fi
fi
{{ end -}}
